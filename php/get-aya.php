<?php 
	// Quran Metadata Sample Usage
	// By: Hamid Zarrabi-Zadeh
	// http://tanzil.net


	$quranFile = 'quran-simple.txt';   // quran file
	$quranFile = 'quran.depag.ri.txt';   // quran file test
	//$transFile = 'trans-english.txt';  // translation file
	$transFile = 'id.indonesian.txt';  // translation file
	$metadataFile = 'quran-data.xml';  // quran metadata file

	initSuraData();   // initialize sura data array
	

	//------------------ General Functions ---------------------


	// initialize sura data array
	function initSuraData()
	{
		global $suraData, $metadataFile;
		$dataItems = Array("index", "start", "ayas", "name", "tname", "ename", "type", "rukus");

		$quranData = file_get_contents($metadataFile);
		$parser = xml_parser_create();
		xml_parse_into_struct($parser, $quranData, $values, $index);
		xml_parser_free($parser);

		for ($i=1; $i<=114; $i++) 
		{
			$j = $index['SURA'][$i-1];
			foreach ($dataItems as $item)
				$suraData[$i][$item] = $values[$j]['attributes'][strtoupper($item)]; 
		}
	}


	// return given property of a sura
	function getSuraData($sura, $property) 
	{
		global $suraData;
		return $suraData[$sura][$property]; 
	}


	// return contents of a sura
	function getAyas($file, $startAya, $endAya) 
	{
		$text = file($file);
		// $startAya = getSuraData($sura, 'start');
		// $endAya = $startAya+ getSuraData($sura, 'ayas');
		$ayas = array_slice($text, $startAya, $endAya- $startAya); 
        $content = array();
        $ayaNum = $startAya;
        foreach ($ayas as $aya) {
            $content[$ayaNum] = $aya;
            $ayaNum++;
        }
		return $content;
	}
    
// request: http://tanzil.net/tanzil/php/get-aya.php?type=simple&transType=en.sahih&pageNum=305&startAya=2250&endAya=2261&version=1.5
// request:           localhost/tanzil/php/get-aya.php?type=simple&transType=en.sahih&pageNum=604&startAya=6221&endAya=6236&version=1.5
// {"pageNum":"305","quranType":"simple","quran":{"2250":"\u0628\u0650\u0633\u0652\u0645\u0650 \u0627\u0644\u0644\u0651\u064e\u0647\u0650 \u0627\u0644\u0631\u0651\u064e\u062d\u0652\u0645\u064e\u0640\u0670\u0646\u0650 \u0627\u0644\u0631\u0651\u064e\u062d\u0650\u064a\u0645\u0650 \u0643\u0647\u064a\u0639\u0635\n","2251":"\u0630\u0650\u0643\u0652\u0631\u064f \u0631\u064e\u062d\u0652\u0645\u064e\u062a\u0650 \u0631\u064e\u0628\u0651\u0650\u0643\u064e \u0639\u064e\u0628\u0652\u062f\u064e\u0647\u064f \u0632\u064e\u0643\u064e\u0631\u0650\u064a\u0651\u064e\u0627\n","2252":"\u0625\u0650\u0630\u0652 \u0646\u064e\u0627\u062f\u064e\u0649\u0670 \u0631\u064e\u0628\u0651\u064e\u0647\u064f \u0646\u0650\u062f\u064e\u0627\u0621\u064b \u062e\u064e\u0641\u0650\u064a\u0651\u064b\u0627\n","2253":"\u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u0650 \u0625\u0650\u0646\u0651\u0650\u064a \u0648\u064e\u0647\u064e\u0646\u064e \u0627\u0644\u0652\u0639\u064e\u0638\u0652\u0645\u064f \u0645\u0650\u0646\u0651\u0650\u064a \u0648\u064e\u0627\u0634\u0652\u062a\u064e\u0639\u064e\u0644\u064e \u0627\u0644\u0631\u0651\u064e\u0623\u0652\u0633\u064f \u0634\u064e\u064a\u0652\u0628\u064b\u0627 \u0648\u064e\u0644\u064e\u0645\u0652 \u0623\u064e\u0643\u064f\u0646 \u0628\u0650\u062f\u064f\u0639\u064e\u0627\u0626\u0650\u0643\u064e \u0631\u064e\u0628\u0651\u0650 \u0634\u064e\u0642\u0650\u064a\u0651\u064b\u0627\n","2254":"\u0648\u064e\u0625\u0650\u0646\u0651\u0650\u064a \u062e\u0650\u0641\u0652\u062a\u064f \u0627\u0644\u0652\u0645\u064e\u0648\u064e\u0627\u0644\u0650\u064a\u064e \u0645\u0650\u0646 \u0648\u064e\u0631\u064e\u0627\u0626\u0650\u064a \u0648\u064e\u0643\u064e\u0627\u0646\u064e\u062a\u0650 \u0627\u0645\u0652\u0631\u064e\u0623\u064e\u062a\u0650\u064a \u0639\u064e\u0627\u0642\u0650\u0631\u064b\u0627 \u0641\u064e\u0647\u064e\u0628\u0652 \u0644\u0650\u064a \u0645\u0650\u0646 \u0644\u0651\u064e\u062f\u064f\u0646\u0643\u064e \u0648\u064e\u0644\u0650\u064a\u0651\u064b\u0627\n","2255":"\u064a\u064e\u0631\u0650\u062b\u064f\u0646\u0650\u064a \u0648\u064e\u064a\u064e\u0631\u0650\u062b\u064f \u0645\u0650\u0646\u0652 \u0622\u0644\u0650 \u064a\u064e\u0639\u0652\u0642\u064f\u0648\u0628\u064e \u06d6 \u0648\u064e\u0627\u062c\u0652\u0639\u064e\u0644\u0652\u0647\u064f \u0631\u064e\u0628\u0651\u0650 \u0631\u064e\u0636\u0650\u064a\u0651\u064b\u0627\n","2256":"\u064a\u064e\u0627 \u0632\u064e\u0643\u064e\u0631\u0650\u064a\u0651\u064e\u0627 \u0625\u0650\u0646\u0651\u064e\u0627 \u0646\u064f\u0628\u064e\u0634\u0651\u0650\u0631\u064f\u0643\u064e \u0628\u0650\u063a\u064f\u0644\u064e\u0627\u0645\u064d \u0627\u0633\u0652\u0645\u064f\u0647\u064f \u064a\u064e\u062d\u0652\u064a\u064e\u0649\u0670 \u0644\u064e\u0645\u0652 \u0646\u064e\u062c\u0652\u0639\u064e\u0644 \u0644\u0651\u064e\u0647\u064f \u0645\u0650\u0646 \u0642\u064e\u0628\u0652\u0644\u064f \u0633\u064e\u0645\u0650\u064a\u0651\u064b\u0627\n","2257":"\u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u0650 \u0623\u064e\u0646\u0651\u064e\u0649\u0670 \u064a\u064e\u0643\u064f\u0648\u0646\u064f \u0644\u0650\u064a \u063a\u064f\u0644\u064e\u0627\u0645\u064c \u0648\u064e\u0643\u064e\u0627\u0646\u064e\u062a\u0650 \u0627\u0645\u0652\u0631\u064e\u0623\u064e\u062a\u0650\u064a \u0639\u064e\u0627\u0642\u0650\u0631\u064b\u0627 \u0648\u064e\u0642\u064e\u062f\u0652 \u0628\u064e\u0644\u064e\u063a\u0652\u062a\u064f \u0645\u0650\u0646\u064e \u0627\u0644\u0652\u0643\u0650\u0628\u064e\u0631\u0650 \u0639\u0650\u062a\u0650\u064a\u0651\u064b\u0627\n","2258":"\u0642\u064e\u0627\u0644\u064e \u0643\u064e\u0630\u064e\u0670\u0644\u0650\u0643\u064e \u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u064f\u0643\u064e \u0647\u064f\u0648\u064e \u0639\u064e\u0644\u064e\u064a\u0651\u064e \u0647\u064e\u064a\u0651\u0650\u0646\u064c \u0648\u064e\u0642\u064e\u062f\u0652 \u062e\u064e\u0644\u064e\u0642\u0652\u062a\u064f\u0643\u064e \u0645\u0650\u0646 \u0642\u064e\u0628\u0652\u0644\u064f \u0648\u064e\u0644\u064e\u0645\u0652 \u062a\u064e\u0643\u064f \u0634\u064e\u064a\u0652\u0626\u064b\u0627\n","2259":"\u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u0650 \u0627\u062c\u0652\u0639\u064e\u0644 \u0644\u0651\u0650\u064a \u0622\u064a\u064e\u0629\u064b \u06da \u0642\u064e\u0627\u0644\u064e \u0622\u064a\u064e\u062a\u064f\u0643\u064e \u0623\u064e\u0644\u0651\u064e\u0627 \u062a\u064f\u0643\u064e\u0644\u0651\u0650\u0645\u064e \u0627\u0644\u0646\u0651\u064e\u0627\u0633\u064e \u062b\u064e\u0644\u064e\u0627\u062b\u064e \u0644\u064e\u064a\u064e\u0627\u0644\u064d \u0633\u064e\u0648\u0650\u064a\u0651\u064b\u0627\n","2260":"\u0641\u064e\u062e\u064e\u0631\u064e\u062c\u064e \u0639\u064e\u0644\u064e\u0649\u0670 \u0642\u064e\u0648\u0652\u0645\u0650\u0647\u0650 \u0645\u0650\u0646\u064e \u0627\u0644\u0652\u0645\u0650\u062d\u0652\u0631\u064e\u0627\u0628\u0650 \u0641\u064e\u0623\u064e\u0648\u0652\u062d\u064e\u0649\u0670 \u0625\u0650\u0644\u064e\u064a\u0652\u0647\u0650\u0645\u0652 \u0623\u064e\u0646 \u0633\u064e\u0628\u0651\u0650\u062d\u064f\u0648\u0627 \u0628\u064f\u0643\u0652\u0631\u064e\u0629\u064b \u0648\u064e\u0639\u064e\u0634\u0650\u064a\u0651\u064b\u0627\n"},
// "transType":"en.sahih","trans":{"2250":"Kaf, Ha, Ya, 'Ayn, Sad.\n","2251":"[This is] a mention of the mercy of your Lord to His servant Zechariah\n","2252":"When he called to his Lord a private supplication.\n","2253":"He said, \"My Lord, indeed my bones have weakened, and my head has filled with white, and never have I been in my supplication to You, my Lord, unhappy.\n","2254":"And indeed, I fear the successors after me, and my wife has been barren, so give me from Yourself an heir\n","2255":"Who will inherit me and inherit from the family of Jacob. And make him, my Lord, pleasing [to You].\"\n","2256":"[He was told], \"O Zechariah, indeed We give you good tidings of a boy whose name will be John. We have not assigned to any before [this] name.\"\n","2257":"He said, \"My Lord, how will I have a boy when my wife has been barren and I have reached extreme old age?\"\n","2258":"[An angel] said, \"Thus [it will be]; your Lord says, 'It is easy for Me, for I created you before, while you were nothing.' \"\n","2259":"[Zechariah] said, \"My Lord, make for me a sign.\" He said, \"Your sign is that you will not speak to the people for three nights, [being] sound.\"\n","2260":"So he came out to his people from the prayer chamber and signaled to them to exalt [Allah] in the morning and afternoon.\n"}}
// $option = $_GET['option'];
$transFile = $_GET['transType'] . '.txt';  // translation file
$res = array(
    'pageNum' => $_GET['pageNum'],
    "quranType" => $_GET['type'],
    "transType" => $_GET['transType'],
    "quran" => getAyas($quranFile, $_GET['startAya'], $_GET['endAya']),
    "trans" => getAyas($transFile, $_GET['startAya'], $_GET['endAya'])
    );
// if ( $option == 1 ) {
    // $data = [ 'a', 'b', 'c' ];
    // will encode to JSON array: ["a","b","c"]
    // accessed as example in JavaScript like: result[1] (returns "b")
// } else {
    // $data = [ 'name' => 'God', 'age' => -1 ];
    // will encode to JSON object: {"name":"God","age":-1}  
    // accessed as example in JavaScript like: result.name or result['name'] (returns "God")
// }

header('Content-type: application/json');
echo json_encode( $res );
/*
{
    "pageNum": "305",
    "quranType": "simple",
    "quran": {
        "2250": "\u0628\u0650\u0633\u0652\u0645\u0650 \u0627\u0644\u0644\u0651\u064e\u0647\u0650 \u0627\u0644\u0631\u0651\u064e\u062d\u0652\u0645\u064e\u0640\u0670\u0646\u0650 \u0627\u0644\u0631\u0651\u064e\u062d\u0650\u064a\u0645\u0650 \u0643\u0647\u064a\u0639\u0635\n",
        "2251": "\u0630\u0650\u0643\u0652\u0631\u064f \u0631\u064e\u062d\u0652\u0645\u064e\u062a\u0650 \u0631\u064e\u0628\u0651\u0650\u0643\u064e \u0639\u064e\u0628\u0652\u062f\u064e\u0647\u064f \u0632\u064e\u0643\u064e\u0631\u0650\u064a\u0651\u064e\u0627\n",
        "2252": "\u0625\u0650\u0630\u0652 \u0646\u064e\u0627\u062f\u064e\u0649\u0670 \u0631\u064e\u0628\u0651\u064e\u0647\u064f \u0646\u0650\u062f\u064e\u0627\u0621\u064b \u062e\u064e\u0641\u0650\u064a\u0651\u064b\u0627\n",
        "2253": "\u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u0650 \u0625\u0650\u0646\u0651\u0650\u064a \u0648\u064e\u0647\u064e\u0646\u064e \u0627\u0644\u0652\u0639\u064e\u0638\u0652\u0645\u064f \u0645\u0650\u0646\u0651\u0650\u064a \u0648\u064e\u0627\u0634\u0652\u062a\u064e\u0639\u064e\u0644\u064e \u0627\u0644\u0631\u0651\u064e\u0623\u0652\u0633\u064f \u0634\u064e\u064a\u0652\u0628\u064b\u0627 \u0648\u064e\u0644\u064e\u0645\u0652 \u0623\u064e\u0643\u064f\u0646 \u0628\u0650\u062f\u064f\u0639\u064e\u0627\u0626\u0650\u0643\u064e \u0631\u064e\u0628\u0651\u0650 \u0634\u064e\u0642\u0650\u064a\u0651\u064b\u0627\n",
        "2254": "\u0648\u064e\u0625\u0650\u0646\u0651\u0650\u064a \u062e\u0650\u0641\u0652\u062a\u064f \u0627\u0644\u0652\u0645\u064e\u0648\u064e\u0627\u0644\u0650\u064a\u064e \u0645\u0650\u0646 \u0648\u064e\u0631\u064e\u0627\u0626\u0650\u064a \u0648\u064e\u0643\u064e\u0627\u0646\u064e\u062a\u0650 \u0627\u0645\u0652\u0631\u064e\u0623\u064e\u062a\u0650\u064a \u0639\u064e\u0627\u0642\u0650\u0631\u064b\u0627 \u0641\u064e\u0647\u064e\u0628\u0652 \u0644\u0650\u064a \u0645\u0650\u0646 \u0644\u0651\u064e\u062f\u064f\u0646\u0643\u064e \u0648\u064e\u0644\u0650\u064a\u0651\u064b\u0627\n",
        "2255": "\u064a\u064e\u0631\u0650\u062b\u064f\u0646\u0650\u064a \u0648\u064e\u064a\u064e\u0631\u0650\u062b\u064f \u0645\u0650\u0646\u0652 \u0622\u0644\u0650 \u064a\u064e\u0639\u0652\u0642\u064f\u0648\u0628\u064e \u06d6 \u0648\u064e\u0627\u062c\u0652\u0639\u064e\u0644\u0652\u0647\u064f \u0631\u064e\u0628\u0651\u0650 \u0631\u064e\u0636\u0650\u064a\u0651\u064b\u0627\n",
        "2256": "\u064a\u064e\u0627 \u0632\u064e\u0643\u064e\u0631\u0650\u064a\u0651\u064e\u0627 \u0625\u0650\u0646\u0651\u064e\u0627 \u0646\u064f\u0628\u064e\u0634\u0651\u0650\u0631\u064f\u0643\u064e \u0628\u0650\u063a\u064f\u0644\u064e\u0627\u0645\u064d \u0627\u0633\u0652\u0645\u064f\u0647\u064f \u064a\u064e\u062d\u0652\u064a\u064e\u0649\u0670 \u0644\u064e\u0645\u0652 \u0646\u064e\u062c\u0652\u0639\u064e\u0644 \u0644\u0651\u064e\u0647\u064f \u0645\u0650\u0646 \u0642\u064e\u0628\u0652\u0644\u064f \u0633\u064e\u0645\u0650\u064a\u0651\u064b\u0627\n",
        "2257": "\u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u0650 \u0623\u064e\u0646\u0651\u064e\u0649\u0670 \u064a\u064e\u0643\u064f\u0648\u0646\u064f \u0644\u0650\u064a \u063a\u064f\u0644\u064e\u0627\u0645\u064c \u0648\u064e\u0643\u064e\u0627\u0646\u064e\u062a\u0650 \u0627\u0645\u0652\u0631\u064e\u0623\u064e\u062a\u0650\u064a \u0639\u064e\u0627\u0642\u0650\u0631\u064b\u0627 \u0648\u064e\u0642\u064e\u062f\u0652 \u0628\u064e\u0644\u064e\u063a\u0652\u062a\u064f \u0645\u0650\u0646\u064e \u0627\u0644\u0652\u0643\u0650\u0628\u064e\u0631\u0650 \u0639\u0650\u062a\u0650\u064a\u0651\u064b\u0627\n",
        "2258": "\u0642\u064e\u0627\u0644\u064e \u0643\u064e\u0630\u064e\u0670\u0644\u0650\u0643\u064e \u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u064f\u0643\u064e \u0647\u064f\u0648\u064e \u0639\u064e\u0644\u064e\u064a\u0651\u064e \u0647\u064e\u064a\u0651\u0650\u0646\u064c \u0648\u064e\u0642\u064e\u062f\u0652 \u062e\u064e\u0644\u064e\u0642\u0652\u062a\u064f\u0643\u064e \u0645\u0650\u0646 \u0642\u064e\u0628\u0652\u0644\u064f \u0648\u064e\u0644\u064e\u0645\u0652 \u062a\u064e\u0643\u064f \u0634\u064e\u064a\u0652\u0626\u064b\u0627\n",
        "2259": "\u0642\u064e\u0627\u0644\u064e \u0631\u064e\u0628\u0651\u0650 \u0627\u062c\u0652\u0639\u064e\u0644 \u0644\u0651\u0650\u064a \u0622\u064a\u064e\u0629\u064b \u06da \u0642\u064e\u0627\u0644\u064e \u0622\u064a\u064e\u062a\u064f\u0643\u064e \u0623\u064e\u0644\u0651\u064e\u0627 \u062a\u064f\u0643\u064e\u0644\u0651\u0650\u0645\u064e \u0627\u0644\u0646\u0651\u064e\u0627\u0633\u064e \u062b\u064e\u0644\u064e\u0627\u062b\u064e \u0644\u064e\u064a\u064e\u0627\u0644\u064d \u0633\u064e\u0648\u0650\u064a\u0651\u064b\u0627\n",
        "2260": "\u0641\u064e\u062e\u064e\u0631\u064e\u062c\u064e \u0639\u064e\u0644\u064e\u0649\u0670 \u0642\u064e\u0648\u0652\u0645\u0650\u0647\u0650 \u0645\u0650\u0646\u064e \u0627\u0644\u0652\u0645\u0650\u062d\u0652\u0631\u064e\u0627\u0628\u0650 \u0641\u064e\u0623\u064e\u0648\u0652\u062d\u064e\u0649\u0670 \u0625\u0650\u0644\u064e\u064a\u0652\u0647\u0650\u0645\u0652 \u0623\u064e\u0646 \u0633\u064e\u0628\u0651\u0650\u062d\u064f\u0648\u0627 \u0628\u064f\u0643\u0652\u0631\u064e\u0629\u064b \u0648\u064e\u0639\u064e\u0634\u0650\u064a\u0651\u064b\u0627\n"
    },
    "transType": "en.sahih",
    "trans": {
        "2250": "Kaf, Ha, Ya, 'Ayn, Sad.\n",
        "2251": "[This is] a mention of the mercy of your Lord to His servant Zechariah\n",
        "2252": "When he called to his Lord a private supplication.\n",
        "2253": "He said, \"My Lord, indeed my bones have weakened, and my head has filled with white, and never have I been in my supplication to You, my Lord, unhappy.\n",
        "2254": "And indeed, I fear the successors after me, and my wife has been barren, so give me from Yourself an heir\n",
        "2255": "Who will inherit me and inherit from the family of Jacob. And make him, my Lord, pleasing [to You].\"\n",
        "2256": "[He was told], \"O Zechariah, indeed We give you good tidings of a boy whose name will be John. We have not assigned to any before [this] name.\"\n",
        "2257": "He said, \"My Lord, how will I have a boy when my wife has been barren and I have reached extreme old age?\"\n",
        "2258": "[An angel] said, \"Thus [it will be]; your Lord says, 'It is easy for Me, for I created you before, while you were nothing.' \"\n",
        "2259": "[Zechariah] said, \"My Lord, make for me a sign.\" He said, \"Your sign is that you will not speak to the people for three nights, [being] sound.\"\n",
        "2260": "So he came out to his people from the prayer chamber and signaled to them to exalt [Allah] in the morning and afternoon.\n"
    }
}
*/
?>
